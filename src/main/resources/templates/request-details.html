<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Детали заявки</title>
    <link rel="stylesheet" th:href="@{/styles/stylesDesign.css}">
</head>
<body>


<div>
    <a href="/request/list">
        <button type="button">Список заявок</button>
    </a>
</div><br/><br/>


<div>
    <form th:action="@{/request/cancel}" method="post"
          th:if="${requestStatus == T(ru.victortikhonov.autoserviceapp.model.Request.RequestStatus).OPEN or
      requestStatus == T(ru.victortikhonov.autoserviceapp.model.Request.RequestStatus).IN_PROGRESS}">
        <input type="hidden" name="requestId" th:value="${request.id}"/>
        <button type="submit">Отменить заявку</button>
    </form>
</div>


<div th:if="${request.workOrder != null}">
    <form th:action="@{/work-order/details}" method="get" target="_blank">
        <input type="hidden" name="workOrderId" th:value="${request.workOrder.id}" />
        <input type="hidden" name="viewMode" value="true" />
        <button type="submit">Открыть заказ-наряд</button>
    </form>
</div>



<!-- Информация о заявке -->
<h1>Детали заявки</h1>

<div>
    <h2>Статус заявки</h2>
    <p th:text="${requestStatus.description}"></p>
</div>

<div>
    <h2>Оператор</h2>
    <p><strong>ФИО: </strong> <span
            th:text="${request.operator.surname} + ' ' + ${request.operator.name} + ' ' + ${request.operator.patronymic}"></span>
    </p>
    <p><strong>Номер телефона: </strong> <span th:text="${request.operator.phoneNumber}"></span></p>
</div>

<div>
    <h2>Клиент</h2>
    <p><strong>ФИО: </strong> <span
            th:text="${request.client.surname} + ' ' + ${request.client.name} + ' ' + ${request.client.patronymic}"></span>
    </p>
    <p><strong>Номер телефона: </strong> <span th:text="${request.client.phoneNumber}"></span></p>
    <p><strong>Email: </strong> <span th:text="${#strings.isEmpty(request.client.email) ? 'отсутствует' : request.client.email}"></span></p>
</div>

<div>
    <h2>Дата создания</h2>
    <p><span th:text=" ${#temporals.format(request.submissionDate, 'dd.MM.yyyy')}"></span></p>
</div>

<div>
    <h2>Машина</h2>
    <p><strong>Марка: </strong> <span th:text="${request.car.brand}"></span></p>
    <p><strong>Модель:</strong> <span th:text="${request.car.model}"></span></p>
    <p><strong>Госномер:</strong> <span th:text="${request.car.stateNumber}"></span></p>
    <p><strong>VIN номер:</strong> <span th:text="${request.car.vin}"></span></p>
</div>

<div>
    <h2>Жалобы</h2>
    <p th:text="${request.complaints}"></p>
</div>


<!-- Кнопка для создания заказ-наряда или сообщение о невозможности взять заявку -->
<div>
    <p style="display: inline; margin-right: 10px;" th:if="${requestStatus == T(ru.victortikhonov.autoserviceapp.model.Request.RequestStatus).OPEN}">
        Приступить к выполнению заявки:</p>
    <form th:if="${requestStatus == T(ru.victortikhonov.autoserviceapp.model.Request.RequestStatus).OPEN}"
          th:action="@{/work-order/create}" method="post" style="display: inline;">
        <input type="hidden" name="requestId" th:value="${request.id}">
        <button type="submit">Начать работу</button>
    </form>
</div>


</body>
</html>
